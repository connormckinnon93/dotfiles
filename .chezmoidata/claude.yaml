# Claude Code configuration
# Managed by chezmoi - edit this file, then run `chezmoi apply`

# Permissions follow a trust gradient:
# - allow: Routine development operations - safe, reversible, low-impact
# - ask: Operations crossing trust boundaries - network, system, packages
# - deny: Irreversible destructive actions - blocked entirely
permissions:
  defaultMode: "acceptEdits"

  allow:
    # Built-in tools
    - "WebFetch"
    - "WebSearch"
    - "Read"
    - "Edit"
    - "Write"
    - "Glob"
    - "Grep"
    - "Search"
    - "Update"

    # Skills (global)
    - "Skill(superpowers:*)"
    - "Skill(claude-mem:*)"
    - "Skill(elements-of-style:*)"
    - "Skill(brainstorming)"
    # Note: anthropic-knowledge-work and anthropic-agent-skills permissions
    # are defined in ~/Workspace/.claude/settings.json (workspace-scoped)

    # MCP tools
    - "mcp__context7__resolve-library-id"
    - "mcp__context7__query-docs"
    - "mcp__plugin_claude-mem_mcp-search__search"
    - "mcp__plugin_claude-mem_mcp-search__timeline"
    - "mcp__plugin_claude-mem_mcp-search__get_observations"

    # Read operations
    - "Bash(cat *)"
    - "Bash(head *)"
    - "Bash(tail *)"
    - "Bash(ls *)"
    - "Bash(find *)"
    - "Bash(grep *)"
    - "Bash(rg *)"
    - "Bash(tree *)"
    - "Bash(wc *)"
    - "Bash(file *)"
    - "Bash(which *)"
    - "Bash(type *)"

    # Git - local operations
    - "Bash(git status*)"
    - "Bash(git log*)"
    - "Bash(git diff*)"
    - "Bash(git show*)"
    - "Bash(git branch*)"
    - "Bash(git add *)"
    - "Bash(git commit *)"
    - "Bash(git checkout *)"
    - "Bash(git switch *)"
    - "Bash(git stash*)"
    - "Bash(git fetch*)"

    # Testing - all languages
    - "Bash(npm test*)"
    - "Bash(npm run test*)"
    - "Bash(npm run lint*)"
    - "Bash(npm run format*)"
    - "Bash(pnpm test*)"
    - "Bash(pnpm run test*)"
    - "Bash(pnpm run lint*)"
    - "Bash(yarn test*)"
    - "Bash(yarn lint*)"
    - "Bash(pytest*)"
    - "Bash(python -m pytest*)"
    - "Bash(go test*)"
    - "Bash(cargo test*)"
    - "Bash(bundle exec rspec*)"
    - "Bash(bundle exec rake test*)"
    - "Bash(rspec *)"
    - "Bash(rake test*)"
    - "Bash(make test*)"
    - "Bash(vitest*)"
    - "Bash(jest *)"

    # Linting & formatting
    - "Bash(eslint *)"
    - "Bash(prettier *)"
    - "Bash(black *)"
    - "Bash(ruff *)"
    - "Bash(mypy *)"
    - "Bash(python -m black*)"
    - "Bash(python -m ruff*)"
    - "Bash(python -m mypy*)"
    - "Bash(bundle exec rubocop*)"

    # Build commands
    - "Bash(npm run build*)"
    - "Bash(pnpm run build*)"
    - "Bash(yarn build*)"
    - "Bash(go build*)"
    - "Bash(cargo build*)"
    - "Bash(make)"
    - "Bash(make build*)"
    - "Bash(tsc*)"

    # Misc commands
    - "Bash(mkdir *)"

  ask:
    # Git - remote/history operations
    - "Bash(git push*)"
    - "Bash(git pull*)"
    - "Bash(git merge *)"
    - "Bash(git rebase *)"

    # Network operations
    - "Bash(curl *)"
    - "Bash(wget *)"
    - "Bash(npm publish*)"
    - "Bash(docker push*)"
    - "Bash(gh *)"

    # Package installation - JS
    - "Bash(npm install*)"
    - "Bash(npm ci*)"
    - "Bash(pnpm install*)"
    - "Bash(pnpm add*)"
    - "Bash(yarn install*)"
    - "Bash(yarn add*)"

    # Package installation - Python
    - "Bash(pip install*)"
    - "Bash(pip3 install*)"
    - "Bash(pipx install*)"
    - "Bash(poetry install*)"
    - "Bash(poetry add*)"
    - "Bash(uv pip install*)"
    - "Bash(uv add*)"

    # Package installation - Ruby
    - "Bash(bundle install*)"
    - "Bash(bundle update*)"
    - "Bash(gem install*)"

    # Package installation - Go/Rust
    - "Bash(cargo install*)"
    - "Bash(go install*)"
    - "Bash(go get*)"

    # System modifications
    - "Bash(brew *)"
    - "Bash(sudo *)"
    - "Bash(chmod *)"
    - "Bash(chown *)"
    - "Bash(launchctl *)"
    - "Bash(defaults *)"

    # Container operations
    - "Bash(docker build*)"
    - "Bash(docker run*)"
    - "Bash(docker compose*)"

  deny:
    # Destructive file operations
    - "Bash(rm -rf *)"
    - "Bash(rm -fr *)"
    - "Bash(rmdir *)"

    # Git - history destruction
    - "Bash(git reset --hard*)"
    - "Bash(git clean -f*)"
    - "Bash(git push --force*)"
    - "Bash(git push -f *)"
    - "Bash(git checkout -- .)"
    - "Bash(git restore .)"

    # Dangerous system commands
    - "Bash(killall *)"
    - "Bash(pkill *)"
    - "Bash(shutdown*)"
    - "Bash(reboot*)"

# Workspace-specific permissions (~/Workspace/.claude/settings.json)
# These are ADDITIONAL to global permissions, applied only in the workspace
# Skill permissions for workspacePlugins are auto-generated from packages.yaml
workspace_permissions:
  allow:
    # Preview generated documents (scoped to workspace)
    - "Bash(open ~/Workspace/*)"

  ask: []

  deny: []

# Workspace MCP connectors (~/Workspace/.mcp.json)
# HTTP-based MCP servers for productivity plugin integrations
# Disabled by default - uncomment 'enabled' list to activate connectors
# Available: slack, notion, asana, linear, atlassian, ms365, monday, clickup
workspace_mcp:
  # enabled:
  #   - slack      # Team messaging (Slack)
  #   - notion     # Knowledge base (Notion)
  #   - linear     # Project tracking (Linear)
  #   - ms365      # Email, calendar, docs (Microsoft 365)
